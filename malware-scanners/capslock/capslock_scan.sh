#!/bin/sh

# Check if REPO_URL and TAG are passed
if [ -z "$REPO_URL" ]; then
    echo "Error: REPO_URL is not set."
    exit 1
fi

if [ -z "$TAG" ]; then
    echo "Error: TAG is not set."
    exit 1
fi

# Clone the repository and checkout the specified tag
echo "Cloning repository: $REPO_URL"
git clone "$REPO_URL" repo || exit 1
cd repo || exit 1
echo "Checking out tag: $TAG"
git checkout "$TAG" || exit 1

# Run capslock on the repository
echo "Running capslock on the repository..."
capslock . || exit 1

# Keep the container running after execution for debugging (optional)
exec "$@"